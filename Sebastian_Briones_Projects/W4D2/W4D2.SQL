--1
SELECT * 
FROM EMP 
WHERE SAL > 3000;

--2
SELECT * 
FROM EMP
WHERE ENAME LIKE 'S%';

--3
SELECT *
FROM EMP
WHERE ENAME IN('SMITH','ALLEN','FORD');

--4
SELECT E.*
FROM EMP E
    ,DEPT D
WHERE E.DEPTNO=D.DEPTNO
AND D.DNAME='SALES';

--5
--AVERAGE
SELECT DEPTNO, ROUND(AVG(SAL),2) AS AVERAGE_SALARY
FROM EMP
GROUP BY DEPTNO
ORDER BY DEPTNO;

--MAX
SELECT DEPTNO, ROUND(MAX(SAL),2) AS MAX_SALARY
FROM EMP
GROUP BY DEPTNO
ORDER BY DEPTNO;

--MIN
SELECT DEPTNO, ROUND(MIN(SAL),2) AS MIN_SALARY
FROM EMP
GROUP BY DEPTNO
ORDER BY DEPTNO;

--6
DECLARE
  CURSOR DEP_CUR IS SELECT DEPTNO FROM DEPT;
  deptnum DEPT.DEPTNO%TYPE;
  EMPCOUNT NUMBER;
BEGIN

  OPEN DEP_CUR;
  LOOP
    FETCH DEP_CUR INTO deptnum;
    EXIT 
    WHEN DEP_CUR%NOTFOUND;
    
    SELECT COUNT(*) INTO EMPCOUNT FROM EMP
    WHERE DEPTNO = deptnum
    AND SAL > 3000;
    
    DBMS_OUTPUT.PUT_LINE('Department'|| deptnum || '-' || EMPCOUNT);
  END LOOP;
  
  CLOSE DEP_CUR;
END;
/


--7
SELECT D.DNAME, E.DEPTNO, ROUND(E.AVERAGE,2) AS AVERAGE_SALARY
FROM DEPT D,
(SELECT DEPTNO, AVG(SAL) AS AVERAGE
FROM EMP
GROUP BY DEPTNO) E
WHERE D.DEPTNO=E.DEPTNO
ORDER BY D.DNAME;


--8
DECLARE

  CURSOR DEP_CUR IS SELECT DEPTNO FROM DEPT;
  DEPTNUM DEPT.DEPTNO%TYPE;
  EMPCOUNT NUMBER;
  EMPSALARY NUMBER;
BEGIN

  OPEN DEP_CUR;
  LOOP
  
    FETCH DEP_CUR INTO DEPTNUM;
    EXIT  WHEN DEP_CUR%NOTFOUND;
    
    EMPCOUNT := 1;
  
    SELECT COUUNT(*) INTO EMPCOUNT FROM EMP
    WHERE DEPTNO = DEPTNUM
    GROUP BY SAL
    HAVING COUNT(*)>1;
    
    DBMS_OUTPUT.PUT_LINE('Department: '|| DEPTNUM || '-- Number of employees:' || EMPCOUNT);
    
  END LOOP;
  CLOSE DEP_CUR;
END;
/



   SELECT COUNT(*)  FROM EMP
    WHERE DEPTNO = 30
    GROUP BY SAL
    HAVING COUNT(*)>1;
    
--9
SELECT D.DNAME,D.LOC, E.EMP_COUNT
FROM DEPT D,
(SELECT COUNT(*) AS EMP_COUNT,DEPTNO
FROM EMP
GROUP BY DEPTNO
HAVING COUNT(*) >1) E
WHERE D.DEPTNO=E.DEPTNO
;


--10
SELECT ENAME,SAL
FROM EMP
WHERE SAL > (SELECT AVG(SAL) FROM EMP);