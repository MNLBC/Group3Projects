/*
 * File: app/controller/MyController.js
 *
 * This file was generated by Sencha Architect version 3.1.0.
 * http://www.sencha.com/products/architect/
 *
 * This file requires use of the Ext JS 5.0.x library, under independent license.
 * License of Sencha Architect does not include license for Ext JS 5.0.x. For more
 * details see http://www.sencha.com/license or contact license@sencha.com.
 *
 * This file will be auto-generated each and everytime you save your project.
 *
 * Do NOT hand edit this file.
 */

Ext.define('app.controller.MyController', {
    extend: 'Ext.app.Controller',

    refs: {
        prodName: '#prodName',
        prodName2: '#prodName',
        prodDiet: '#prodDet',
        prodPrice: '#prodPrice',
        gadgetSix: '#gadgetSix',
        cartGrid: '#cartGrid',
        mytextfield2: '#mytextfield2',
        logPassword: '#logPassword',
        logUser: '#logUser',
        mainContainers: '#mainContainers',
        login: '#Login',
        homePage: '#HomePage'
    },

    control: {
        "#gadgetOne": {
            click: 'btnGadget1'
        },
        "#gadgetTwo": {
            click: 'btnGadget2'
        },
        "#gadgetThree": {
            click: 'btnGadget3'
        },
        "#gadgetFour": {
            click: 'btnGadget4'
        },
        "#gadgetFive": {
            click: 'btnGadget5'
        },
        "#gadgetSix": {
            click: 'btnGadget6'
        },
        "#gadgetSeven": {
            click: 'btnGadget7'
        },
        "#gadgetEight": {
            click: 'btnGadget8'
        },
        "#gadgetNine": {
            click: 'btnGadget9'
        },
        "#gadgetTen": {
            click: 'btnGadget10'
        },
        "#addToCart": {
            click: 'onAddToCartClick'
        },
        "#removeItems": {
            click: 'onRemoveItemsClick'
        },
        "#checkOut": {
            click: 'onCheckOutClick'
        },
        "#btnLogin": {
            click: 'onBtnLoginClick'
        },
        "#Register": {
            click: 'onRegisterClick'
        }
    },

    btnGadget1: function() {
        var prod = Ext.getStore('productStore');
        var name = prod.data.items[0].data.productname;
        var price = prod.data.items[0].data.price;
        var details = prod.data.items[0].data.details;


        this.getProdName().setValue(name);

        this.getProdPrice().setValue(price);
        this.getProdDiet().setValue(details);



        // //prod.each(function(record){
        //           var test = record.get('productStore').;



         //         });
    },

    btnGadget2: function() {
        var prod = Ext.getStore('productStore');
                var name = prod.data.items[1].data.productname;
                var price = prod.data.items[1].data.price;
                var details = prod.data.items[1].data.details;


                this.getProdName().setValue(name);

                this.getProdPrice().setValue(price);
                this.getProdDiet().setValue(details);
    },

    btnGadget3: function() {
         var prod = Ext.getStore('productStore');
                        var name = prod.data.items[2].data.productname;
                        var price = prod.data.items[2].data.price;
                        var details = prod.data.items[2].data.details;


                        this.getProdName().setValue(name);

                        this.getProdPrice().setValue(price);
                        this.getProdDiet().setValue(details);
    },

    btnGadget4: function() {
         var prod = Ext.getStore('productStore');
                        var name = prod.data.items[3].data.productname;
                        var price = prod.data.items[3].data.price;
                        var details = prod.data.items[3].data.details;


                        this.getProdName().setValue(name);

                        this.getProdPrice().setValue(price);
                        this.getProdDiet().setValue(details);
    },

    btnGadget5: function() {
         var prod = Ext.getStore('productStore');
                        var name = prod.data.items[4].data.productname;
                        var price = prod.data.items[4].data.price;
                        var details = prod.data.items[4].data.details;


                        this.getProdName().setValue(name);

                        this.getProdPrice().setValue(price);
                        this.getProdDiet().setValue(details);
    },

    btnGadget6: function() {
         var prod = Ext.getStore('productStore');
                                var name = prod.data.items[5].data.productname;
                                var price = prod.data.items[5].data.price;
                                var details = prod.data.items[5].data.details;


                                this.getProdName().setValue(name);

                                this.getProdPrice().setValue(price);
                                this.getProdDiet().setValue(details);
    },

    btnGadget7: function() {
         var prod = Ext.getStore('productStore');
                                        var name = prod.data.items[6].data.productname;
                                        var price = prod.data.items[6].data.price;
                                        var details = prod.data.items[6].data.details;


                                        this.getProdName().setValue(name);

                                        this.getProdPrice().setValue(price);
                                        this.getProdDiet().setValue(details);
    },

    btnGadget8: function() {
                                    var prod = Ext.getStore('productStore');
                                        var name = prod.data.items[7].data.productname;
                                        var price = prod.data.items[7].data.price;
                                        var details = prod.data.items[7].data.details;


                                        this.getProdName().setValue(name);

                                        this.getProdPrice().setValue(price);
                                        this.getProdDiet().setValue(details);
    },

    btnGadget9: function() {
                                    var prod = Ext.getStore('productStore');
                                        var name = prod.data.items[8].data.productname;
                                        var price = prod.data.items[8].data.price;
                                        var details = prod.data.items[8].data.details;


                                        this.getProdName().setValue(name);

                                        this.getProdPrice().setValue(price);
                                        this.getProdDiet().setValue(details);
    },

    btnGadget10: function() {
                                    var prod = Ext.getStore('productStore');
                                        var name = prod.data.items[9].data.productname;
                                        var price = prod.data.items[9].data.price;
                                        var details = prod.data.items[9].data.details;


                                        this.getProdName().setValue(name);

                                        this.getProdPrice().setValue(price);
                                        this.getProdDiet().setValue(details);
    },

    onAddToCartClick: function() {
        var name=this.getProdName().getValue();
        var price= this.getProdPrice().getValue();
        var prod = Ext.getStore('cartStore');

        var cart = 	[{productname:name ,price:price}];

        prod.add(cart);


    },

    onRemoveItemsClick: function() {


                var cartGrid= this.getCartGrid();
                var cartStore = cartGrid.getStore();

                //delete selected rows if selModel is checkboxmodel
                var selectedRows = cartGrid.getSelectionModel().getSelection();

                if(selectedRows.length)
                    cartStore.remove(selectedRows);
                else
                    Ext.Msg.alert('Status', 'Please select at least one record to delete!');

    },

    onCheckOutClick: function() {
        var receipt=0;
        //                 var cartGrid= this.getCartGrid();
        //                 var cartStore = cartGrid.getStore();
        // var cartStore = Ext.getStore('cartStore').data.items[0].data.productname;
        var cartStore = Ext.getStore('cartStore');

        cartStore.each(function(record){
            receipt+=record.data.price;
                       });


        Ext.MessageBox.confirm('Checking out..','The total cost of your order is: '+receipt+ ' Do you want to check out now?',function(btn){
            if (btn=='yes'){
                cartStore.removeAll();
            }

        });



    },

    onBtnLoginClick: function() {
                var userStore = Ext.getStore('userStore');
                var username = this.getLogUser().getValue();
                var password = this.getLogPassword().getValue();
                var flag = false;
                userStore.each(function(record){
                    var uname = record.get('username');
                    var pword = record.get('password');

                    if (uname ===username && pword === password){
                        flag = true;
                    }

                });

                if (flag){
                    Ext.MessageBox.alert('Login', 'Successfully Logged In');
                     this.getHomePage().hide();
                    this.getMainContainers().show();



                }
    },

    onRegisterClick: function() {
             Ext.create('Ext.window.Window',
                                   {
                                       renderTo : Ext.getBody(),
                                        bodyPadding: 10,
                    title: 'Registration Window',
                    closable: true,
                    autoShow: true,
                                       resizable:false,
                                       draggable:false,
                                       width:800,
                                       height:285,
                                       items: [
                        {
                            xtype: 'form',
                            autoScroll: true,
                            bodyBorder: true,
                            bodyPadding: 10,

                            layout: {
                                type: 'vbox',
                                align: 'stretch'
                            },
                            items: [
                                {
                                    xtype: 'textfield',
                                    width: 1002,

                                    fieldLabel: 'Username',
                                    id:'txtUser'
                                },
                                {
                                    xtype: 'textfield',
                                    width: 1002,
                                    inputType: 'password',
                                    fieldLabel: 'Password',
                                    id:'txtPassword'
                                },
                                {
                                    xtype: 'textfield',
                                            flex: 0,
                                            width: 370,
                                            fieldLabel: 'Name',
                                    id:'txtName'
                                },
                                {
                                    xtype: 'container',
                                    flex: 0,
                                    width: 496,
                                    layout: {
                                        type: 'vbox',
                                        align: 'center'
                                    },
                                    items: [
                                        {
                                            xtype: 'button',
                                            width: 118,
                                            text: 'Register',
                                            handler:function(){
                                                alert('you xlcik');

                var userStore = Ext.getStore('userStore');

                var userName = Ext.getCmp('txtUser').getValue();
                var pass = Ext.getCmp('txtPassword').getValue();
                var fullName = Ext.getCmp('txtName').getValue();
                var user = 	[{username:userName ,password:pass, name:fullName}];
                userStore.add(user);
                Ext.MessageBox.alert('Register', userName);
                                            }
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                                   });
    }

});
